# Ralph Progress Log
Started: Sun Jan 11 02:28:40 +08 2026
---

## Sun Jan 11 2026 - US-001
Thread: https://ampcode.com/threads/T-019ba92a-f5be-70cc-a827-74679e8f64c9
- Added `vscode-code-notes.aiTool` setting with enum: 'claude', 'opencode', 'custom' (default: 'claude')
- Added `vscode-code-notes.aiToolCommand` setting for custom command path (string, default: '')
- Ran `pnpm run update` to regenerate meta.ts
- Typecheck and lint pass
- Files changed: package.json, src/generated/meta.ts
- **Learnings for future iterations:**
  - Use `pnpm run update` after modifying package.json contributes.configuration to regenerate meta.ts
  - vscode-ext-gen auto-generates typed settings access in meta.ts
---

## Sun Jan 11 2026 - US-002
Thread: https://ampcode.com/threads/T-019ba92c-780d-762d-ae0a-60ee9c1de733
- Added `vscode-code-notes.promptTemplates` setting as object with default 'review' template
- Template supports `{{comments}}` and `{{files}}` placeholders for variable substitution
- Used `additionalProperties` schema to allow arbitrary named templates
- Ran `pnpm run update` to regenerate meta.ts
- Typecheck and lint pass
- Files changed: package.json, src/generated/meta.ts
- **Learnings for future iterations:**
  - Use `additionalProperties` in JSON schema when defining object settings with arbitrary keys
  - Default values for object settings are validated against the schema automatically
---

## Sun Jan 11 2026 - US-003
Thread: https://ampcode.com/threads/T-019ba92e-8145-7132-a52b-0de509c32dbf
- Created src/aiReview.ts with formatCommentsForAI(comments: Comment[]) function
- Function groups comments by file path and formats each as: [category] file:startLine-endLine - text
- Returns object with { formattedComments: string, files: string[] }
- Typecheck and lint pass
- Files changed: src/aiReview.ts
- **Learnings for future iterations:**
  - The Comment type is defined in src/types.ts with filePath, startLine, endLine, text, category fields
  - When formatting line ranges, use single line number if startLine === endLine
---

## Sun Jan 11 2026 - US-004
Thread: https://ampcode.com/threads/T-019ba92f-efc0-73ce-8bb9-b11b0fca2494
- Added buildAICommand(tool, customCommand, prompt) function to src/aiReview.ts
- Handles 'claude', 'opencode', and 'custom' tool types
- Escapes double quotes in prompts to prevent command injection
- Claude uses: `claude -p --permission-mode plan "prompt"`
- OpenCode uses: `opencode run --agent plan "prompt"`
- Custom appends quoted prompt to custom command
- Typecheck and lint pass
- Files changed: src/aiReview.ts
- **Learnings for future iterations:**
  - Double quotes in prompts must be escaped for shell commands
  - Use switch statement with default fallback for tool selection
---

## Sun Jan 11 2026 - US-005
Thread: https://ampcode.com/threads/T-019ba931-78b4-77ae-8637-ee371abf7369
- Implemented sendToAI command in src/commands.ts
- Reads aiTool, aiToolCommand, and promptTemplates from config using configs from meta.ts
- Gets all comments from storage, shows error if none exist
- Formats comments using formatCommentsForAI from aiReview.ts
- Applies default 'review' template with {{comments}} and {{files}} placeholders replaced
- Creates terminal with window.createTerminal('AI Review')
- Sends command to terminal with terminal.sendText() and shows with terminal.show()
- Registered command as codeReview.sendToAI
- Typecheck and lint pass
- Files changed: src/commands.ts
- **Learnings for future iterations:**
  - Use workspace.getConfiguration().get() with configs.X.key and configs.X.default for type-safe config access
  - Terminal commands can be executed via window.createTerminal() and terminal.sendText()
---

## Sun Jan 11 2026 - US-006
Thread: https://ampcode.com/threads/T-019ba933-86ff-7077-8f9f-b4cd5d696337
- Added codeReview.sendToAI command to package.json with title "Send to AI Review" and icon $(sparkle)
- Added command to view/title menu for codeReviewComments view with navigation@3 group
- Added keyboard shortcut Ctrl+Shift+A (Cmd+Shift+A on Mac)
- Ran pnpm run update to regenerate meta.ts
- Typecheck and lint pass
- Files changed: package.json, src/generated/meta.ts
- **Learnings for future iterations:**
  - Use navigation@N group to order items in view/title menu
  - Keybindings use "ctrl+shift+x" format on Windows/Linux and "cmd+shift+x" for Mac
---

## Sun Jan 11 2026 - US-007
Thread: https://ampcode.com/threads/T-019ba935-7190-708e-9e2b-d9c4a9af81ea
- Added sendSelectedToAI command in src/commands.ts with QuickPick for multi-selection
- QuickPick shows comments grouped by file (label: truncated text up to 50 chars, description: file:lineRange)
- Uses canPickMany: true for multi-select functionality
- Selected comments are filtered and sent to AI using existing formatCommentsForAI and buildAICommand
- Registered command as codeReview.sendSelectedToAI
- Added command to package.json with title "Send Selected to AI" and icon $(checklist)
- Ran pnpm run update to regenerate meta.ts
- Typecheck and lint pass
- Files changed: src/commands.ts, package.json, src/generated/meta.ts
- **Learnings for future iterations:**
  - QuickPick items can have custom properties (like comment) to carry data along with display
  - Use canPickMany: true for multi-select QuickPick dialogs
---

## Sat Jan 11 2026 - US-008
Thread: https://ampcode.com/threads/T-019ba947-1575-70c0-971e-60b526ff81d8
- Implemented sendCategoryToAI command in src/commands.ts
- Shows QuickPick to select category (bug, question, suggestion, nitpick, note)
- Filters comments by selected category and sends to AI
- Shows appropriate message if no comments exist for selected category
- Registered command as codeReview.sendCategoryToAI
- Added command to package.json with title "Send Category to AI" and icon $(tag)
- Ran pnpm run update to regenerate meta.ts
- Typecheck and lint pass
- Files changed: src/commands.ts, package.json, src/generated/meta.ts
- **Learnings for future iterations:**
  - Reuse existing config access patterns from sendToAI and sendSelectedToAI
  - Category filtering is simple array filter on the category property
---

## Sun Jan 11 2026 - US-009
Thread: https://ampcode.com/threads/T-019ba948-caea-77bd-9876-71f139a0afe0
- Created pickPromptTemplate helper function with QuickPick for template selection
- Shows all configured templates plus "Custom..." option for one-time prompts
- Custom option opens InputBox for user to enter a custom prompt
- Templates support {{comments}} and {{files}} placeholders which are replaced
- Updated sendToAI, sendSelectedToAI, and sendCategoryToAI to use the picker
- Extracted template selection into shared helper to reduce code duplication
- Typecheck and lint pass
- Files changed: src/commands.ts
- **Learnings for future iterations:**
  - Use `value: null` pattern in QuickPick items to detect "special" options like Custom
  - Helper functions can accept formatted data and return the final prompt after user selection
  - QuickPick can be followed by InputBox for progressive disclosure of options
---
